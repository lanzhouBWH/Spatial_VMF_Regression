Spatial_VMF_Regression
=====================

This code repository accompanies the manuscript "Spatial von-Mises Fisher Regression for Directional Data" with all the implementation codes and specific codes to reproduce Figure 4 from Section 4.1. Below are some remarks.

- Prerequisite: a) Please make the folder "Spatial_VMF_Regression" under the root directory; b) Please ensure the functions in the folder "Functions" are sourced correctly.

- Main Script: The file "Reproduce_Figure4.R" reproduces the method comparisons illustrated in Figure 4.

  * At the top of this file a flag variable 'run' is defined with default 'run=FALSE'. This allows to load all the saved simulation outputs from 'Spatial_VMF_Regression/Codes_to_reproduce_Figure4/Simulation_Output/' to reproduce the figures.
  * By setting it 'TRUE,' one can rerun all the simulations and resave all the results in 'Spatial_VMF_Regression/Codes_to_reproduce_Figure4/Simulation_Output/'.

- Simulation Details:

  * The folder "Code" provides three scripts for generating simulation outputs. The code comments in each script show three major steps: a) Simulation Data Generation (Training and Validation); b) MCMC fitting; c) Evaluation Metrics Calculation
    ** VMF_SIM: The simulation script for spatial vmf regression
    ** NORMAL_SIM: The simulation script for spatial vmf regression
    ** NonSpatial_VMF_SIM: The simulation script for non-spatial vmf regression

  * Simulation_Output: Includes generated simulation outputs of values of evaluation metrics used for visualizations. 
    ** "VMF_FITTING_P_XX_kappa_YY_Rep_NN.Rdata": NN-th simulation output for spatial VMF regression with P=XX, kappa=YY
      *** "Validation_lmvmf_p$alpha": a V*M matrix of separation angles for V voxels and M subjects.
      *** "Validation_lmvmf_p.regular$alpha": a V*M matrix of Rooted root mean square error for V voxels and M subject
    ** "VMF_Normal1__kappa_YY_Rep_NN.Rdata": NN-th simulation output for Gaussian Regression 1 with kappa=YY
      *** "Validation_Validation_Normal1$alpha": a V*M matrix of separation angles for V voxels and M subjects.
      *** "Validation_Validation_Normal1.regular$alpha": a V*M matrix of Rooted root mean square error for V voxels and M subject
    ** "VMF_Normal2__kappa_YY_Rep_NN.Rdata": NN-th simulation output for Gaussian Regression 2 with kappa=YY
      *** "Validation_Validation_Normal2$alpha": a V*M matrix of separation angles for V voxels and M subjects.
      *** "Validation_Validation_Normal2.regular$alpha": a V*M matrix of Rooted root mean square error for V voxels and M subject
    ** "NonSpatial_VMF_FITTING_kappa_YY_Rep_NN.Rdata": 
      *** "Validation_lmvmf_p$alpha": a V*M matrix of separation angles for V voxels and M subjects.
      *** "Validation_lmvmf_p.regular$alpha": a V*M matrix of Rooted root mean square error for V voxels and M subject
